---
title: "Training Your First AI Model"
description: "Get started with AI by quickly training your first image classifier AI model."
imageUrl: "/images/blog/training-your-first-ai-model/album-covers.webp"
dateWritten: "2024-02-21"
isDraft: true
tags:
  - Artificial Intelligence
---

<img alt="Album covers from vinyl records on display on shelves" src="/images/blog/training-your-first-ai-model/album-covers.webp" width="1500" height="991">

# Training Your First AI Model

> Note: If you ever get stuck while implementing the directions in this article, you can refer to [this finished Kaggle notebook](https://www.kaggle.com/code/thnate/first-ai-model) for a solution.

## Start Your Engine

There's something magical that happens when you manage to get code to do what you want. The itch is almost universal among hackers and coders, and it's why they keep coming back again and again.

When I first got addicted to programming, I loved the fact I could write code that would do exactly what I wanted it to even while I was asleep. For instance, you're reading this and I'm doing something completely different. I love that.

With the recent boom in artificial intelligence, we can take this once step further and create code that will predict, classify, and generate content for us.

A great course you can use to learn about this is one by FastAI called [Practical Deep Learning for Coders](https://course.fast.ai/). I'll be summarizing the first few chapters in a condensced format here that should get you up off the ground with your first model trained and deployed for use in no time.

We'll be building an [image classifier](https://huggingface.co/docs/transformers/tasks/image_classification) in this article, which means you can upload an image to it and it will predict whether it's a certain animal, shape, car, or whatever you decide to build.

I'd encourage you to think about what you want to make. Do you want to make an image classifier for dogs and cats? Perhaps you want to make one for [different types of food](https://www.youtube.com/watch?v=ACmydtFDTGs)?

> "It is difficult to think of a major industry that AI will not transform. This includes healthcare, education, transportation, retail, communications, and agriculture. There are surprisingly clear paths for AI to make a big difference in all of these industries."
>
> \- Andrew Ng

## Get Yourself Some GPUs

The first thing we need to do is sign up for a Kaggle account so that you can have a server and temporary access to GPUs for training your model.

Kaggle is a site that, among other things, allows people like you to participate in competitions for data science/building models; it also will allow you to run code in "notebooks" (more on this in a second) and train models _on its site_ using GPU servers.

<img alt="The Kaggle homepage" src="/images/blog/training-your-first-ai-model/kaggle-homepage.webp" height="967" width="1600">

Go ahead and head over to [kaggle.com](https://www.kaggle.com) to create a free account. I'll be here when you get back.

Ready?

Awesome. Next, go ahead and hit the `Create` button (which you'll see on the lefthand side if you go to your profile) to create a new notebook. Once you do, you'll see a blank notebook page that looks like this:

<img alt="A blank new Kaggle notebook without any code in it" src="/images/blog/training-your-first-ai-model/new-kaggle-notebook.webp" height="968" width="1600">

Go ahead and give it a new title like "My First AI Model" or "First AI Model" for now.

Okay, let's take a break for a second and talk through what we've done. First off, what is a "notebook" and why do we need it?

What I'm calling a "notebook" is really a [Jupyter Notebook](https://jupyter.org). What are those you might ask? Jupyter Notebooks are web-based development environments for data science and machine learning.

In other words, they're the environment we're going to run code in to create our AI models!

Now that you have a new notebook, go ahead and write the following code blocks in it (using the `+ Code` button when hovering in the main page):

```bash
!pip install fastbook
```

```python
import fastbook
fastbook.setup_book()
```

This is what it should look like:

<img alt="The new Kaggle notebook with a few cells of code in it" src="/images/blog/training-your-first-ai-model/first-notebook-cells.webp" height="967" width="1600">

Each code block should have a ‚ñ∂Ô∏è play button on the lefthand side if you click on the code block itself. Go ahead and press it for each of these.

You'll see a lot of text spit out for the first code block, but it's just indicative that it's installing Python modules for us to use. `Fastbook` is a dependency that speeds up our development by quick-installing a lot of the dependencies we'll need. The second code block is initial setup.

Next, add (and run) another code block with the following Python code:

```python
from fastbook import *
from fastai.vision.widgets import *
```

`fastai` is a package developed by the company [FastAI](https://www.fast.ai/) as a wrapper around [PyTorch](https://pytorch.org/) with lots of sane defaults so that you and I can get to hacking.

This is what it should look like once you're done:

<img alt="Final initial setup code cell in Kaggle notebook" src="/images/blog/training-your-first-ai-model/finished-initial-setup.webp" height="967" width="1600">

Good job üî•

Now it's time to download some real data so that we can train our model!

> "I imagine a world in which AI is going to make us work more productively, live longer, and have cleaner energy."
>
> \- Fei-Fei Li

## Download Your Data

So far, we've only really been concerned with setup. But in this section, we're going to download the data we'll need to train our AI model!

Remember earlier when I encouraged you to think of what kind of image classifier you were wanting to train? Well, it's time to use what you've decided on and jump in with both feet.

Go ahead and write the following code in a new code block (replacing `"guitars"` with whatever you want your model to predict):

```python
results = search_images_ddg("guitars")
len(results)
```

It should look like this:

<img alt="DuckDuckGo initial search in code block" src="/images/blog/training-your-first-ai-model/duck-duck-go-initial-search.webp" height="967" width="1600">

Once you run that, it should say something like `200` undernearth your code block. This is indicative of the number of results that were found matching your search!

Next, go ahead and add the following two code blocks and run them both:

```python
destination = 'images/guitars.jpg'
download_url(results[0], destination)
```

```python
image = Image.open(destination)
image.to_thumb(128,128)
```

It should look like this:

<img alt="Sampling image data from DuckDuckGo" src="/images/blog/training-your-first-ai-model/sampling-image-data.webp" height="967" width="1600">

Nice. This is always a good idea to do as we're effectively sampling the image data to make sure we're pulling in something that we'd expect from our search query term.

Next, we need to setup all our queries. These will be other categories for images to fall into. I'm going to search for `"basses"` and `"harmonicas"` as well to keep with the whole music theme:

```python
instrument_types = "guitar", "electric bass", "harmonica"
path = Path("instruments")
```

This declares a list of instruments (or whatever you decide to train your model on) that our image classifier will place images into.

Finally, we've defined an `instruments` path which will be our root directory where a separate folder for each `instrument_types` string will be created in to download its associated images into.

Next, go ahead and make and run this code block (replacing "instrument" with whatever the parent category is for the type of images you're downloading):

```python
if not path.exists():
    path.mkdir()

for o in instrument_types:
    dest = (path/o)
    dest.mkdir(exist_ok=True)
    results = search_images_ddg(f'{o} instrument')
    download_images(dest, urls=results)
```

This will take quite a bit of time to run. You're using DuckDuckGo to download images. You can actually see them downloading in real time if you open up the right sidebar (with the array on the bottom-right part of your screen) and then dig down to the files here:

<img alt="Downloading images from DuckDuckGo" src="/images/blog/training-your-first-ai-model/downloading-images.webp" height="967" width="1600">

Once this code block finishes running, you now have your dataset for training your model!

Before using this data, we should remove any errored image paths that failed to download.

Go ahead and paste this code into a code block and then run it:

```python
fns = get_image_files(path)
failed = verify_images(fns)
len(failed)
```

Here's what it looked like for me when I ran it:

<img alt="Checking how many image paths have errored out while downloading from DuckDuckGo" src="/images/blog/training-your-first-ai-model/errored-image-paths.webp" height="967" width="1600">

Go ahead and remove those by putting this code into a code block and running it:

> Note: This will unlink the errored images the first time you run it. If you run it a second time, it will error out as there aren't any image paths to remove anymore.

```python
failed.map(Path.unlink);
```

Next, we need to sample the data we've downloaded to make sure it's valid. In order to do that, we need to setup up some data loaders to manipulate our images.

Go ahead and jump into the next section to do that when you're ready.

> ‚ÄúSome people worry that artificial intelligence will make us feel inferior, but then, anybody in his right mind should have an inferiority complex every time he looks at a flower.‚Äù
>
> \- Alan Kay

## Setting Up Our Dataloaders

In order to manipulate our data, we're going to use a class exported from `fastai` called a `Dataloader`.

Go ahead and create (and, like always, run) this code block:

```python
instruments = DataBlock(
    blocks=(ImageBlock, CategoryBlock),
    get_items=get_image_files,
    splitter=RandomSplitter(valid_pct=0.2, seed=42),
    get_y=parent_label,
    item_tfms=RandomResizedCrop(224, min_scale=0.5),
    batch_tfms=aug_transforms(),
)
```

Okay. What's going on here?

Good question.

First, we have this line

```python
dls = bears.dataloaders(path)
```

## Train Your New Model

## Export Your Model

## Build an Interface Using Gradio

## Conclusion

There you go. You've trained a new model to do what you want _and_ learned how to deploy it and turn it into an API.

From here, the sky is the limit. I'd _highly_ recommend you go check out FastAI's [Practical Deep Learning for Coders](https://course.fast.ai/) course if you want to learn more. This article covers roughly the first two lectures.

Feel free to shoot me a message on the contact form on this website with whatever you've created! I'd love to see it.

As always, thanks for reading.

Nathan ‚òï
